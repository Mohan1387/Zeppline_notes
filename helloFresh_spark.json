{"paragraphs":[{"text":"%spark2.pyspark\n\nfrom pyspark.sql import SQLContext\nsqlcontext = SQLContext(sc)\nRecipes_df = sqlcontext.read.json(\"hdfs:///user/duhdpuser/hellofresh/recipes.json\")\nRecipes_df.show()","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-------------+--------------------+--------------------+--------------------+--------------------+--------+-----------+--------------------+\n|cookTime|datePublished|         description|               image|         ingredients|                name|prepTime|recipeYield|                 url|\n+--------+-------------+--------------------+--------------------+--------------------+--------------------+--------+-----------+--------------------+\n|      PT|   2013-04-01|Got leftover East...|http://static.the...|12 whole Hard Boi...|Easter Leftover S...|   PT15M|          8|http://thepioneer...|\n|   PT10M|   2011-06-06|I finally have ba...|http://static.the...|3/4 cups Fresh Ba...|Pasta with Pesto ...|    PT6M|          8|http://thepioneer...|\n|   PT15M|   2011-09-15|This was yummy. A...|http://static.the...|2 whole Pork Tend...|Herb Roasted Pork...|    PT5M|         12|http://thepioneer...|\n|   PT20M|   2012-04-23|I made this for a...|http://static.the...|1 pound Penne\n4 w...|Chicken Florentin...|   PT10M|         10|http://thepioneer...|\n|      PT|   2011-06-13|Iced coffee is my...|http://static.the...|1 pound Ground Co...| Perfect Iced Coffee|    PT8H|         24|http://thepioneer...|\n|   PT10M|   2012-05-31|When I was in Alb...|http://static.the...|1 whole Onion, Di...|Easy Green Chile ...|    PT5M|          4|http://thepioneer...|\n|    PT5M|   2013-03-25|Imagine the Easte...|http://static.the...|4 Tablespoons But...|  Krispy Easter Eggs|   PT20M|         12|http://thepioneer...|\n|   PT25M|   2012-08-06|Who doesn't love ...|http://static.the...|1 stick Butter\n1 ...|         Patty Melts|   PT10M|          4|http://thepioneer...|\n|    PT2M|   2012-08-10|Note from PW: On ...|http://static.the...| Doughnuts\n1-1/8 ...|     Yum. Doughnuts!|   PT25M|         18|http://thepioneer...|\n|   PT15M|   2012-08-01|This is just a qu...|http://static.the...|1 pound Pasta (fe...|Buttery Lemon Par...|    PT5M|          8|http://thepioneer...|\n| PT1H15M|   2012-08-13|There's nothing s...|http://static.the...|1 whole Chicken, ...|       Roast Chicken|   PT10M|          4|http://thepioneer...|\n|    PT1H|   2012-08-18|On this morning's...|http://static.the...| FRENCH TOAST\n Bu...|  Baked French Toast|   PT15M|          8|http://thepioneer...|\n|   PT10M|   2012-08-15|I love slice-and-...|http://static.the...|2-1/2 cups All-pu...|Yummy Slice-and-B...|   PT15M|         30|http://thepioneer...|\n|   PT20M|   2012-08-20|I love grilled ve...|http://static.the...|6 whole Zucchini ...|Yummy Grilled Zuc...|   PT30M|          8|http://thepioneer...|\n|   PT10M|   2012-08-29|When we went to V...|http://static.the...|16 whole Graham C...|Chocolate Covered...|   PT20M|          8|http://thepioneer...|\n|    PT5M|   2012-08-22|I love compound b...|http://static.the...| HOTEL BUTTER\n2 s...|T-Bone Steaks wit...|   PT20M|          4|http://thepioneer...|\n|      PT|   2012-08-31| I've got Mango M...|http://static.the...|2 whole Limes\n2 T...|   Mango Margaritas!|   PT10M|          8|http://thepioneer...|\n|   PT45M|   2012-01-04|I'm Pioneer Woman...|http://static.the...|5 cloves Garlic, ...|Tuscan Bean Soup ...|   PT10M|          8|http://thepioneer...|\n|    PT1H|   2011-12-30|I'm not a big bel...|http://static.the...|4 Tablespoons But...|        Hoppin’ John|    PT6H|         10|http://thepioneer...|\n|   PT15M|   2012-01-11|I would like to s...|http://static.the...|8 whole Everythin...| Turkey Bagel Burger|   PT10M|          8|http://thepioneer...|\n+--------+-------------+--------------------+--------------------+--------------------+--------------------+--------+-----------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1512914044141_-408364100","id":"20171210-175404_576537940","dateCreated":"2017-12-10T17:54:04+0400","dateStarted":"2017-12-10T18:03:17+0400","dateFinished":"2017-12-10T18:03:23+0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:477"},{"text":"%pyspark\nRecipes_df.registerTempTable('Recepie_table')","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512914234757_2005274664","id":"20171210-175714_747384041","dateCreated":"2017-12-10T17:57:14+0400","dateStarted":"2017-12-10T18:07:37+0400","dateFinished":"2017-12-10T18:07:37+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:478"},{"text":"%pyspark\nfiltered_recepie = sqlcontext.sql(\"select cookTime,datePublished,description,image,ingredients,name,prepTime,recipeYield, url from Recepie_table where lower(ingredients) like '%beef%' \")","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512914790370_1407756333","id":"20171210-180630_280237279","dateCreated":"2017-12-10T18:06:30+0400","dateStarted":"2017-12-11T12:48:26+0400","dateFinished":"2017-12-11T12:48:26+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:479"},{"text":"%pyspark\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import *\n\nimport re\n\ndef total_time(a):\n\n\tline = a[2:]\n\n\tsearchObj1 = re.search( r'^(\\d*)H(\\d*)M$', line)\n\tsearchObj2 = re.search( r'^(\\d*)H$', line)\n\tsearchObj3 = re.search( r'^(\\d*)M$', line)\n\tif searchObj1:\n\t  total_mins = searchObj1.group(1)\n\t  total_mins = int(total_mins)\n\t  total_mins = total_mins*60\n\t  mins = searchObj1.group(2)\n\t  mins = int(mins)\n\t  total_mins = total_mins+mins\n\t  return total_mins\n\telif searchObj2:\n\t  total_mins = searchObj2.group(1)\n\t  total_mins = int(total_mins)\n\t  total_mins = total_mins*60\n\t  return total_mins\n\telif searchObj3:\n\t  total_mins = searchObj3.group(1)\n\t  total_mins = int(total_mins)\n\t  return total_mins\n\telse:\n\t  return 0","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512915435605_479247202","id":"20171210-181715_1785780787","dateCreated":"2017-12-10T18:17:15+0400","dateStarted":"2017-12-11T17:53:46+0400","dateFinished":"2017-12-11T17:53:46+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:480"},{"text":"%pyspark\ntype(filtered_recepie)\nudfcook_mins = udf(total_time, StringType())\nfiltered_recepie_one = filtered_recepie.withColumn(\"cooktime_mins\",udfcook_mins(\"cookTime\"))\n#filtered_recepie_rdd = filtered_recepie.rdd.map(lambda x: (x['cookTime'],total_time(x['cookTime'])))\n#filtered_recepie_one =rdd.toDF()\n#filtered_recepie.select('cookTime').collect()","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512915922192_254824223","id":"20171210-182522_1326950967","dateCreated":"2017-12-10T18:25:22+0400","dateStarted":"2017-12-11T17:56:32+0400","dateFinished":"2017-12-11T17:56:32+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:481"},{"text":"%pyspark\nfiltered_recepie_one = filtered_recepie_one.withColumn(\"preptime_mins\",udfcook_mins(\"prepTime\"))\n","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1512990156546_1158868278","id":"20171211-150236_1598466186","dateCreated":"2017-12-11T15:02:36+0400","dateStarted":"2017-12-11T17:59:27+0400","dateFinished":"2017-12-11T17:59:27+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:482"},{"text":"%pyspark\nfiltered_recepie_one.registerTempTable('Recepie_table_total_time')","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1513000647205_-1902055604","id":"20171211-175727_1452615189","dateCreated":"2017-12-11T17:57:27+0400","dateStarted":"2017-12-11T18:27:04+0400","dateFinished":"2017-12-11T18:27:04+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483"},{"text":"%pyspark\n#recepie_total_time = filtered_recepie_one.select('*',(filtered_recepie_one.cooktime_mins + filtered_recepie_one.preptime_mins).alias('total_time')).collect()\nrecepie_total_time = sqlcontext.sql(\"select a.cookTime,a.datePublished,a.description,a.image,a.ingredients,a.name,a.prepTime,a.recipeYield,a.url,case when a.total_time >= 60 then 'Hard' when a.total_time < 60 and a.total_time >= 30 then 'Medium' when a.total_time < 30 then 'Easy' else 'Unknown' End as difficulty from (select cookTime,datePublished,description,image,ingredients,name,prepTime,recipeYield,url,(cooktime_mins + preptime_mins) as total_time from Recepie_table_total_time) a\")\n","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1513000795229_-931872119","id":"20171211-175955_433486229","dateCreated":"2017-12-11T17:59:55+0400","dateStarted":"2017-12-12T10:15:08+0400","dateFinished":"2017-12-12T10:15:08+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:484"},{"text":"%pyspark\nrecepie_total_time.show()","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-------------+--------------------+--------------------+--------------------+--------------------+--------+-----------+--------------------+----------+\n|cookTime|datePublished|         description|               image|         ingredients|                name|prepTime|recipeYield|                 url|difficulty|\n+--------+-------------+--------------------+--------------------+--------------------+--------------------+--------+-----------+--------------------+----------+\n|   PT25M|   2012-08-06|Who doesn't love ...|http://static.the...|1 stick Butter\n1 ...|         Patty Melts|   PT10M|          4|http://thepioneer...|    Medium|\n|    PT3H|   2012-01-30|My oh my, was thi...|http://static.the...|2 Tablespoons Can...|Spicy Stewed Beef...|   PT20M|         12|http://thepioneer...|      Hard|\n|   PT25M|   2012-02-08|This was really, ...|http://static.the...|6 whole Pork Chop...|Pork Chops with G...|    PT5M|          6|http://thepioneer...|    Medium|\n|   PT20M|   2012-10-26|I felt like makin...|http://static.the...| MEAT MIXTURE\n1-1...|Salisbury Steak, ...|   PT10M|          6|http://thepioneer...|    Medium|\n|    PT4H|   2012-09-04|This is a yummy p...|http://static.the...|2 Tablespoons Oli...|Hot &amp; Spicy I...|    PT5M|         16|http://thepioneer...|      Hard|\n|   PT25M|   2012-09-10|*SPOILER ALERT*  ...|http://static.the...|4 whole 6-ounce B...|Surf &amp; Turf C...|   PT20M|          4|http://thepioneer...|    Medium|\n|    PT1H|   2012-09-19|A-spaghetti witho...|http://static.the...|5 pounds Ground B...|     Spaghetti Sauce|   PT20M|         18|http://thepioneer...|      Hard|\n|   PT10M|   2012-10-01|I made pizza burg...|http://static.the...|1-1/2 pound Groun...|Pepperoni Pizza B...|    PT5M|          4|http://thepioneer...|      Easy|\n|   PT15M|   2012-10-11|A couple of weeks...|http://static.the...|1-1/2 pound Groun...|Supreme Pizza Bur...|    PT5M|          4|http://thepioneer...|      Easy|\n|    PT3H|   2011-09-22|I think I've esta...|http://static.the...|12 whole Shortrib...|Short Ribs with W...|   PT10M|          6|http://thepioneer...|      Hard|\n|    PT2H|   2011-11-07|Pork roast. Apple...|http://static.the...| Pork\n3 Tablespoo...|Pork Roast with A...|   PT15M|          8|http://thepioneer...|      Hard|\n|   PT15M|   2011-12-28|Are you having a ...|http://static.the...|2 pounds Ground M...|Spicy Whiskey BBQ...|   PT15M|          6|http://thepioneer...|    Medium|\n|   PT30M|   2009-11-30|Did you hear the ...|http://static.the...|2 pounds Beef Ste...|Beef Stew with Mu...|   PT25M|          8|http://thepioneer...|    Medium|\n| PT2H30M|   2011-01-14|(Updated notes/re...|http://static.the...|3 Tablespoons Oli...|Beef Stew with Be...|   PT10M|          6|http://thepioneer...|      Hard|\n|   PT11M|   2010-07-12|First, an importa...|http://static.the...|2 pounds Ground B...|Beef and Bean Bur...|    PT5M|          6|http://thepioneer...|      Easy|\n|   PT45M|   2009-03-26|Foodies, please c...|http://static.the...| FOR MEATBALLS\n1-...|BBQ Comfort Meatb...|   PT15M|          6|http://thepioneer...|      Hard|\n|   PT20M|   2010-12-29|This recipe was a...|http://static.the...|1-1/4 pound Groun...|Meatballs with Pe...|   PT20M|          8|http://thepioneer...|    Medium|\n|    PT4H|   2011-03-07|I've said it befo...|http://static.the...|8 whole Beef Shor...|Short Ribs in Tom...|   PT10M|          6|http://thepioneer...|      Hard|\n|    PT4H|   2012-10-22|I made this scrum...|http://static.the...|2 whole Beef Chuc...|   Italian Pot Roast|    PT1M|         12|http://thepioneer...|      Hard|\n|   PT40M|   2009-01-18|By Pastor Ryan.  ...|http://static.the...|3 whole Bell Pepp...|      Cajun Meatloaf|   PT40M|          8|http://thepioneer...|      Hard|\n+--------+-------------+--------------------+--------------------+--------------------+--------------------+--------+-----------+--------------------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1513001867649_-1909820101","id":"20171211-181747_1511132264","dateCreated":"2017-12-11T18:17:47+0400","dateStarted":"2017-12-12T10:15:12+0400","dateFinished":"2017-12-12T10:15:13+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:485"},{"text":"%pyspark\nrecepie_total_time.write.parquet(\"hdfs:///user/duhdpuser/hellofresh/recepie_with_difficulty.parquet\")","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1513002612441_-1499956897","id":"20171211-183012_468743071","dateCreated":"2017-12-11T18:30:12+0400","dateStarted":"2017-12-12T10:36:28+0400","dateFinished":"2017-12-12T10:36:29+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:486"},{"text":"%pyspark\nrecepie_total_time.registerTempTable('Recepie_table_diff')","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1513060328122_-1807818427","id":"20171212-103208_1733424843","dateCreated":"2017-12-12T10:32:08+0400","dateStarted":"2017-12-12T12:53:28+0400","dateFinished":"2017-12-12T12:53:28+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:487"},{"text":"%pyspark\nsqlcontext.sql(\"select difficulty,count(difficulty) from Recepie_table_diff group by difficulty\").show()\n#sqlcontext.sql(\"select count(*) from Recepie_table_diff\").show()","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-----------------+\n|difficulty|count(difficulty)|\n+----------+-----------------+\n|      Easy|                8|\n|    Medium|               12|\n|      Hard|               27|\n+----------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1513068671324_709346722","id":"20171212-125111_1848266889","dateCreated":"2017-12-12T12:51:11+0400","dateStarted":"2017-12-12T13:06:47+0400","dateFinished":"2017-12-12T13:06:48+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:488"},{"text":"%spark2.sql\n","user":"admin","dateUpdated":"2017-12-12T14:56:07+0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1513068772875_-414783940","id":"20171212-125252_1102894191","dateCreated":"2017-12-12T12:52:52+0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:489"}],"name":"helloFresh_spark","id":"2D3KABPGV","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CKX6DGQZ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKX8WPU1:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}